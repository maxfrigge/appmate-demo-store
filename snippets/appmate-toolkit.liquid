{{ 'https://az814789.vo.msecnd.net/toolkit/1.0.7/appmate.js' | script_tag }}
{{ 'appmate-wishlist.scss.css' | asset_url | stylesheet_tag }}

<script type="text/javascript">
    ;(function(){
        if (typeof Appmate === 'undefined') return; // In case lib didn't load.

        Appmate.init({
            shop: {
                domain: '{{ shop.domain }}'
            },

            session: {
              customer: '{{ customer.id }}'
            },

            globals: {
                settings: {{ settings | json }}
            }
        });

        // Flavor: Extended with callbacks
        Appmate.wk.on({
            'click .wishlist-remove-button': function(event){
                event.preventDefault();

                var item = this.getAttribute('data-wishlist-item');
                Appmate.wk.wishlist.removeItem(item);
            },
            'click .wishlist-toggle-button': function(event){
                event.preventDefault();

                var product = this.getAttribute('data-product');
                var variant = $(this).parents('form').find('select[name="id"]').val();
                Appmate.wk.wishlist.toggleProduct(product, variant);
            },
            'click .wishlist-clear-button': function(event){
                event.preventDefault();

                Appmate.wk.wishlist.clear();
            },
            'render .wishlist-option-select': function(elem){
                initOptionSelect(elem);
            },
            'destroy .wishlist-option-select': function(elem){
                console.log('Destroy element', elem);
            },
            'render .add-to-cart': function(elem){
                initAddToCart(elem);
            },
            'destroy .add-to-cart': function(elem){
                console.log('Destroy element', elem);
            }
        });

        // Flavor: Compact
        // Appmate.on({
        //     'click .wishlist-remove-button': 'wishlist.removeProduct',
        //     'click .wishlist-toggle-button': 'wishlist.toggleProduct'
        // });

    })();

</script>

{% include 'appmate-markup' %}
